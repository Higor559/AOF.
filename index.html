<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notícias Esportivas</title>
    <style>
        :root {
            --bg: #0E1A2A;
            --text: #FFFFFF;
            --accent: #1E90FF;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: var(--accent);
            padding: 10px;
            text-align: center;
        }

        #editorContainer {
            display: none;
            background: #13233F;
            padding: 15px;
            margin: 10px;
            border-radius: 10px;
        }

        #noticiasContainer {
            padding: 15px;
        }

        button {
            background: var(--accent);
            border: none;
            padding: 10px 15px;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background: #0d6efd;
        }

        .noticia {
            background: #1a2f52;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 10px;
        }

        img {
            width: 100%;
            border-radius: 10px;
            margin-top: 8px;
        }
    </style>
</head>

<body>
    <header>
        <h1>Notícias Esportivas</h1>
        <button id="abrirEditor">✏️ Editor</button>
    </header>

    <div id="editorContainer">
        <h2>Adicionar Notícia</h2>
        <input type="text" id="titulo" placeholder="Título da notícia" style="width:100%;margin-bottom:8px;"><br>
        <textarea id="conteudo" placeholder="Conteúdo da notícia"
            style="width:100%;height:100px;margin-bottom:8px;"></textarea><br>
        <input type="file" id="imagem" accept="image/*"><br><br>
        <button id="salvarNoticia">Salvar Notícia</button>
    </div>

    <div id="noticiasContainer"></div>

    <script>
        window.onload = () => {
            const editorContainer = document.getElementById("editorContainer");
            const noticiasContainer = document.getElementById("noticiasContainer");
            const btnAbrir = document.getElementById("abrirEditor");
            const btnSalvar = document.getElementById("salvarNoticia");
            const tituloInput = document.getElementById("titulo");
            const conteudoInput = document.getElementById("conteudo");
            const imagemInput = document.getElementById("imagem");
            let db;

            // Abre IndexedDB
            const request = indexedDB.open("noticiasDB", 1);
            request.onupgradeneeded = (event) => {
                db = event.target.result;
                db.createObjectStore("noticias", { keyPath: "id", autoIncrement: true });
            };
            request.onsuccess = (event) => {
                db = event.target.result;
                carregarNoticias();
            };

            // Alternar editor
            btnAbrir.onclick = () => {
                editorContainer.style.display = editorContainer.style.display === "none" ? "block" : "none";
            };

            // Salvar notícia
            btnSalvar.onclick = () => {
                const titulo = tituloInput.value.trim();
                const conteudo = conteudoInput.value.trim();
                const imagemFile = imagemInput.files[0];

                if (!titulo || !conteudo) {
                    alert("Preencha título e conteúdo.");
                    return;
                }

                if (imagemFile) {
                    const reader = new FileReader();
                    reader.onload = () => {
                        salvarNoBanco({ titulo, conteudo, imagem: reader.result });
                    };
                    reader.readAsDataURL(imagemFile);
                } else {
                    salvarNoBanco({ titulo, conteudo, imagem: null });
                }
            };

            // Salvar no IndexedDB
            function salvarNoBanco(noticia) {
                const tx = db.transaction("noticias", "readwrite");
                const store = tx.objectStore("noticias");
                store.add(noticia);
                tx.oncomplete = () => {
                    tituloInput.value = "";
                    conteudoInput.value = "";
                    imagemInput.value = "";
                    carregarNoticias();
                    alert("Notícia salva!");
                };
            }

            // Carregar notícias
            function carregarNoticias() {
                noticiasContainer.innerHTML = "";
                const tx = db.transaction("noticias", "readonly");
                const store = tx.objectStore("noticias");
                store.openCursor().onsuccess = (event) => {
                    const cursor = event.target.result;
                    if (cursor) {
                        const noticia = cursor.value;
                        const div = document.createElement("div");
                        div.className = "noticia";
                        div.innerHTML = `
              <h3>${noticia.titulo}</h3>
              <p>${noticia.conteudo}</p>
              ${noticia.imagem ? <img src="${noticia.imagem}" alt="Imagem da notícia"> : ""}
                                `;
                                noticiasContainer.prepend(div);
                                cursor.continue();
          }
        };
      }
    };
    </script>
</body>

</html>
